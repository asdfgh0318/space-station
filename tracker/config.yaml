# Space Station - Antenna Tracker Configuration
# Waveshare Stepper Motor HAT (B) + NEMA 17 + GT2 Belt Drive

site:
  name: "Warsaw"
  latitude: 52.2297
  longitude: 21.0122
  elevation: 100

tracker:
  type: "alt-az"
  driver: "waveshare_hat_b"

  azimuth:
    # Mechanical — GT2 belt, 1:1 ratio (20T pulleys both ends)
    gear_ratio: 1
    steps_per_rev: 200       # NEMA 17 full steps
    microstepping: 32        # Set via DIP switches on HAT (all switches at 1)
    # Calculated: 200 * 32 * 1 = 6400 microsteps per revolution
    # Resolution: 360 / 6400 = 0.05625 deg per microstep

    min_angle: 0.0
    max_angle: 360.0
    max_speed: 15.0          # deg/s
    acceleration: 8.0        # deg/s^2

    # GPIO pins — Waveshare HAT (B) Motor 1 (BCM numbering)
    step_pin: 19
    dir_pin: 13
    enable_pin: 12

    # Homing
    home_switch_pin: 5
    home_switch_enabled: false  # No limit switches on bench
    home_offset: 0.0

  elevation:
    gear_ratio: 1
    steps_per_rev: 200
    microstepping: 32        # Set via DIP switches on HAT (all switches at 1)

    min_angle: 0.0
    max_angle: 90.0
    max_speed: 12.0
    acceleration: 6.0

    # GPIO pins — Waveshare HAT (B) Motor 2
    step_pin: 18
    dir_pin: 24
    enable_pin: 4

    # Homing
    home_switch_pin: 6
    home_switch_enabled: false
    home_offset: 0.0

  park_azimuth: 0.0
  park_elevation: 90.0
  position_tolerance: 0.1
  tracking_interval: 0.5

sdr:
  device_index: 0
  default_sample_rate: 2400000
  default_gain: 40.0

lnb:
  inverto_ku_pll:
    model: "Inverto IDLB-SINL40"
    type: "PLL"
    lo_low: 9750000000
    lo_high: 10600000000
    switch_freq: 11700000000

  # GPIO pins for LNB control (relocated from HAT-conflicting pins)
  gpio:
    power_pin: 23
    voltage_select_pin: 25
    tone_pin: 26
